# 🧪 AI 编剧室 - 完整测试计划

**测试日期**: 2026-01-18  
**版本**: v1.0.0  
**测试方法**: 自动化浏览器测试 + 手动验证

---

## 📋 测试用例总览

### Phase 1: 初始化与角色生成
- ✅ TC-001: 页面加载
- ✅ TC-002: 初始状态显示
- ✅ TC-003: 主题输入功能
- ✅ TC-004: 角色生成流程
- ✅ TC-005: 角色卡片显示

### Phase 2: 剧本生成流程
- ✅ TC-006: 场景规划
- ✅ TC-007: 对话生成
- ✅ TC-008: 场景总结
- ✅ TC-009: 多场景循环
- ✅ TC-010: 实时流式输出

### Phase 3: UI 交互功能
- ✅ TC-011: 暂停/继续功能
- ✅ TC-012: 重置功能
- ✅ TC-013: 复制到剪贴板
- ✅ TC-014: 导出文本文件
- ✅ TC-015: 活动日志显示

### Phase 4: 响应式与样式
- ✅ TC-016: 桌面端显示
- ✅ TC-017: 移动端显示
- ✅ TC-018: 主题与样式一致性

### Phase 5: 错误处理
- ✅ TC-019: API 错误处理
- ✅ TC-020: 网络错误恢复
- ✅ TC-021: 边界条件处理

---

## 🔍 详细测试用例

### TC-001: 页面加载测试
**优先级**: P0 (Critical)  
**前置条件**: 开发服务器运行在 http://localhost:3000

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 打开浏览器，访问 http://localhost:3000 | 页面成功加载 |
| 2 | 检查页面标题 | 显示 "AI 编剧室 - 多智能体电影剧本生成系统" |
| 3 | 检查页面元素 | 显示主题输入框、标题、描述文字 |
| 4 | 检查控制台 | 无 JavaScript 错误 |

**验证点**:
- [ ] 页面标题正确
- [ ] 无 404 或加载错误
- [ ] 所有静态资源加载成功
- [ ] 控制台无错误

---

### TC-002: 初始状态显示
**优先级**: P0 (Critical)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 检查主输入区域 | 显示 "AI 编剧室" 标题 |
| 2 | 检查输入框 | 占位符显示 "例如：一个关于人工智能觉醒的科幻故事" |
| 3 | 检查按钮状态 | "开始创作" 按钮可用 |
| 4 | 检查右侧面板 | 活动日志为空或显示初始提示 |

**验证点**:
- [ ] UI 布局正确（左右分屏）
- [ ] 输入框可编辑
- [ ] 按钮样式正确
- [ ] 无剧本内容显示

---

### TC-003: 主题输入功能
**优先级**: P0 (Critical)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 在主题输入框输入文字 | 文字正常显示 |
| 2 | 输入中文字符 | 中文输入正常 |
| 3 | 输入空格和标点 | 所有字符正常输入 |
| 4 | 清空输入 | 输入框正常清空 |

**测试数据**:
- "一个关于人工智能觉醒的科幻故事"
- "现代都市爱情故事"
- "悬疑推理剧本"

**验证点**:
- [ ] 输入无延迟
- [ ] 中文输入法支持
- [ ] 输入框自动调整

---

### TC-004: 角色生成流程
**优先级**: P0 (Critical)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 输入主题："一个关于人工智能觉醒的科幻故事" | 输入成功 |
| 2 | 点击 "开始创作" 按钮 | 按钮变为禁用状态 |
| 3 | 观察状态变化 | 状态变为 "正在生成角色..." |
| 4 | 等待 API 响应 | 显示加载指示器 |
| 5 | 角色生成完成 | 显示 3-4 个角色卡片 |

**验证点**:
- [ ] API 调用成功
- [ ] 生成 3-4 个角色
- [ ] 每个角色有完整信息（姓名、背景、性格、说话风格）
- [ ] 活动日志更新

---

### TC-005: 角色卡片显示
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 检查角色卡片布局 | 卡片水平排列 |
| 2 | 检查角色信息 | 姓名、背景、性格特征、说话风格完整 |
| 3 | 检查视觉样式 | 卡片有边框、阴影、间距合理 |
| 4 | 检查响应式 | 小屏幕下卡片堆叠 |

**验证点**:
- [ ] 角色信息完整且为中文
- [ ] 每个角色有唯一 ID
- [ ] 视觉呈现专业美观
- [ ] 性格特征以标签形式显示

---

### TC-006: 场景规划
**优先级**: P0 (Critical)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 角色生成后自动开始 | 系统开始规划第一个场景 |
| 2 | 观察活动日志 | 显示 "导演正在规划场景 1..." |
| 3 | 等待场景规划完成 | 显示场景标题（INT./EXT. + 地点） |
| 4 | 检查剧本面板 | 场景标题出现在左侧剧本面板 |

**验证点**:
- [ ] 场景标题格式正确（INT./EXT.）
- [ ] 场景地点合理且为中文
- [ ] 场景目标明确
- [ ] 活动日志记录完整

---

### TC-007: 对话生成
**优先级**: P0 (Critical)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 场景规划后自动开始 | 演员开始对话 |
| 2 | 观察对话生成 | 每个角色轮流说话 |
| 3 | 检查对话格式 | 角色名 + 对话内容 |
| 4 | 检查对话次数 | 生成 6-10 轮对话 |
| 5 | 检查对话质量 | 对话符合角色性格和场景目标 |

**验证点**:
- [ ] 对话实时流式显示
- [ ] 对话内容为中文
- [ ] 角色说话符合其 speaking_style
- [ ] 对话推动场景目标

---

### TC-008: 场景总结
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 对话结束后 | 系统开始总结场景 |
| 2 | 观察活动日志 | 显示 "正在总结场景..." |
| 3 | 等待总结完成 | 显示场景总结内容 |
| 4 | 检查全局状态 | story summary 已更新 |

**验证点**:
- [ ] 场景总结简洁明了
- [ ] 总结为中文
- [ ] 捕捉场景核心事件
- [ ] 全局故事摘要更新

---

### TC-009: 多场景循环
**优先级**: P0 (Critical)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 第一场景完成后 | 自动开始规划第二场景 |
| 2 | 观察场景编号 | 场景编号递增（场景 2） |
| 3 | 等待多个场景生成 | 至少生成 3 个场景 |
| 4 | 观察故事连贯性 | 场景之间有逻辑关联 |

**验证点**:
- [ ] 场景自动循环
- [ ] 最多生成 5 个场景
- [ ] 每个场景独立完整
- [ ] 故事整体连贯

---

### TC-010: 实时流式输出
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 观察对话生成过程 | 文字逐字或逐词出现 |
| 2 | 检查滚动行为 | 剧本面板自动滚动到底部 |
| 3 | 检查性能 | 无卡顿或延迟 |
| 4 | 检查视觉反馈 | 有明显的"正在生成"提示 |

**验证点**:
- [ ] 流式输出流畅
- [ ] 自动滚动正常
- [ ] 无内存泄漏
- [ ] UI 响应及时

---

### TC-011: 暂停/继续功能
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 剧本生成过程中 | 点击 "暂停" 按钮 |
| 2 | 观察生成状态 | 生成停止 |
| 3 | 检查按钮文字 | 按钮变为 "继续" |
| 4 | 点击 "继续" 按钮 | 生成恢复 |
| 5 | 检查活动日志 | 记录暂停和继续事件 |

**验证点**:
- [ ] 暂停立即生效
- [ ] 继续后从断点继续
- [ ] 按钮状态切换正确
- [ ] 日志记录完整

---

### TC-012: 重置功能
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 任意阶段 | 点击 "重置" 按钮 |
| 2 | 观察剧本面板 | 剧本内容清空 |
| 3 | 观察活动日志 | 日志清空 |
| 4 | 观察输入区域 | 恢复到初始状态 |
| 5 | 观察角色卡片 | 角色卡片消失 |

**验证点**:
- [ ] 所有状态重置
- [ ] UI 恢复到初始状态
- [ ] 可以重新开始创作
- [ ] 无残留数据

---

### TC-013: 复制到剪贴板
**优先级**: P2 (Medium)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 有剧本内容时 | 点击 "复制" 按钮 |
| 2 | 观察按钮反馈 | 显示 "已复制" 提示 |
| 3 | 粘贴到文本编辑器 | 内容格式正确 |
| 4 | 检查格式 | 场景标题、角色名、对话格式正确 |

**验证点**:
- [ ] 复制成功
- [ ] 格式保持完整
- [ ] 中文字符正确
- [ ] 剧本格式标准

---

### TC-014: 导出文本文件
**优先级**: P2 (Medium)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 有剧本内容时 | 点击 "导出" 按钮 |
| 2 | 观察浏览器行为 | 触发文件下载 |
| 3 | 检查文件名 | 文件名包含时间戳 |
| 4 | 打开文件 | 内容完整，格式正确 |

**验证点**:
- [ ] 文件下载成功
- [ ] 文件名合理
- [ ] 文件内容完整
- [ ] 字符编码正确（UTF-8）

---

### TC-015: 活动日志显示
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 生成过程中 | 观察右侧活动日志 |
| 2 | 检查日志内容 | 每个步骤都有记录 |
| 3 | 检查时间戳 | 每条日志有时间戳 |
| 4 | 检查图标 | 不同类型事件有不同图标 |

**验证点**:
- [ ] 日志实时更新
- [ ] 日志内容清晰
- [ ] 时间戳准确
- [ ] 图标使用恰当

---

### TC-016: 桌面端显示
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 使用 1920x1080 分辨率 | 页面布局正常 |
| 2 | 检查左右分屏 | 剧本和日志各占合理比例 |
| 3 | 检查字体大小 | 字体清晰易读 |
| 4 | 检查间距 | 元素间距合理 |

**验证点**:
- [ ] 布局美观
- [ ] 内容不溢出
- [ ] 滚动流畅
- [ ] 视觉层次清晰

---

### TC-017: 移动端显示
**优先级**: P2 (Medium)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 调整窗口到 375px 宽度 | 布局自适应 |
| 2 | 检查分屏行为 | 可能变为上下布局或折叠 |
| 3 | 检查按钮大小 | 按钮适合触摸 |
| 4 | 检查文字大小 | 文字可读 |

**验证点**:
- [ ] 响应式布局生效
- [ ] 无横向滚动
- [ ] 触摸友好
- [ ] 内容可访问

---

### TC-018: 主题与样式一致性
**优先级**: P2 (Medium)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 检查颜色方案 | 使用一致的配色 |
| 2 | 检查字体 | 字体统一 |
| 3 | 检查动画 | 过渡动画流畅 |
| 4 | 检查阴影和边框 | 视觉风格一致 |

**验证点**:
- [ ] Tailwind 样式应用正确
- [ ] Shadcn/UI 组件样式完整
- [ ] 无样式冲突
- [ ] 整体美观专业

---

### TC-019: API 错误处理
**优先级**: P1 (High)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 修改 .env.local，使用无效 API key | 重启服务器 |
| 2 | 尝试生成角色 | 显示错误提示 |
| 3 | 检查错误信息 | 错误信息清晰友好 |
| 4 | 检查恢复能力 | 可以重试或重置 |

**验证点**:
- [ ] 错误被捕获
- [ ] 错误提示用户友好
- [ ] 不影响应用稳定性
- [ ] 提供恢复方法

---

### TC-020: 网络错误恢复
**优先级**: P2 (Medium)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 生成过程中 | 模拟网络中断 |
| 2 | 观察应用行为 | 显示网络错误 |
| 3 | 恢复网络 | 应用可以继续或重试 |

**验证点**:
- [ ] 网络错误被处理
- [ ] 用户收到通知
- [ ] 可以重试操作
- [ ] 无崩溃

---

### TC-021: 边界条件处理
**优先级**: P2 (Medium)

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 输入空字符串 | 按钮禁用或提示 |
| 2 | 输入超长文本 | 正常处理或限制长度 |
| 3 | 输入特殊字符 | 正常处理不报错 |
| 4 | 快速多次点击按钮 | 防抖，不重复请求 |

**验证点**:
- [ ] 输入验证正确
- [ ] 无异常崩溃
- [ ] 用户体验良好
- [ ] 边界情况覆盖

---

## 📊 测试执行记录

### 执行摘要
- **总测试用例数**: 21
- **通过**: _
- **失败**: _
- **阻塞**: _
- **跳过**: _

### 测试环境
- **操作系统**: macOS (darwin 25.1.0)
- **浏览器**: Chromium (Playwright)
- **Node.js**: 20.x
- **Next.js**: 15.1.6

### 问题追踪
| ID | 测试用例 | 问题描述 | 严重程度 | 状态 | 修复版本 |
|----|----------|----------|----------|------|----------|
| - | - | - | - | - | - |

---

## ✅ 测试完成标准

测试被认为完成且通过，当：
- [ ] 所有 P0 用例 100% 通过
- [ ] 所有 P1 用例 ≥95% 通过
- [ ] 所有 P2 用例 ≥90% 通过
- [ ] 无阻塞性 bug
- [ ] 核心功能流程完整可用
- [ ] 用户体验良好

---

**测试负责人**: AI Assistant  
**审核人**: User  
**测试周期**: 2026-01-18  
**下次测试**: 每次发布前
